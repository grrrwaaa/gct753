<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<script src="al.js"></script>
<style>
body {
	background: #eee;
	width: 512px;
	min-height: 100%;
	margin: 50px auto 50px auto;
}
</style>
</head>
<body>
<canvas id="canvas1" width=512 height=256></canvas>
<script>
al.init("canvas1");

var w = 256, h = 128;
var game = new field2D(w, h);
var past = new field2D(w, h);

function init_game_cell(x, y) {
	if (random() < 0.5) {
		return 0;
	} else {
		return 1;
	}
}

function reset() {
	game.set(init_game_cell);
}
reset();

function update_game_cell(x, y) {
	var N = past.get(x, y+1);
	var S = past.get(x, y-1);
	var E = past.get(x+1, y);
	var W = past.get(x-1, y);
	var NE = past.get(x+1, y+1);
	var NW = past.get(x-1, y+1);
	var SE = past.get(x+1, y-1);
	var SW = past.get(x-1, y-1);
	var total = N + S + E + W + NE + NW + SE + SW;	
	var C = past.get(x, y);
	
	if (C == 1) {
		// currently alive:
		if (total < 2) {
			return 0;
		} else if (total > 3) {
			return 0;
		} else {
			return 1;
		}
	} else {
		// currently dead:
		if (total == 3) {
			return 1;
		} else {
			return 0;
		}
	}
}

function update() {
	var tmp = past;
	past = game;
	game = tmp;
	
	// random noise:
	game.set(random(2), random(w), random(h));
	
	game.set(update_game_cell);
} 

function draw() {
	game.draw()
}

al.start();
</script>
</body>
</html>